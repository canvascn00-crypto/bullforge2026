<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bullforge | The Future isn't Just Bullish. It's Bullforge.</title>

  <!-- ethers v5 (ä¿æŒä¸å˜) -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>

  <!-- å­—ä½“ -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap" rel="stylesheet">

  <style>
    /* ==================== å…¨å±€æ ·å¼ ==================== (å®Œå…¨ä¿ç•™åŸæ ·) */
    :root {
      --gold-primary: #FFD700;
      --gold-secondary: #FFA500;
      --dark-bg: #050505;
      --dark-card: #0F0F0F;
      --dark-border: #1A1A1A;
      --text-white: #FFFFFF;
      --text-gray: #A0A0A0;
      --text-muted: #666666;
      --danger: #FF4444;
      --success: #00C853;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
    html { scroll-behavior: smooth; }
    body { background-color: var(--dark-bg); color: var(--text-white); line-height: 1.6; overflow-x: hidden; }
    .container { max-width: 1400px; margin: 0 auto; padding: 0 24px; }

    /* ==================== å›ºå®šå¯¼èˆªæ  ==================== */
    .navbar {
      position: fixed; top: 0; left: 0; width: 100%; z-index: 999;
      padding: 16px 0; background: rgba(5, 5, 5, 0.9);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--dark-border);
    }
    .navbar-content { display: flex; justify-content: space-between; align-items: center; }
    .navbar-logo { font-size: 28px; font-weight: 900; color: var(--gold-primary); letter-spacing: -0.5px; }
    .navbar-links { display: flex; gap: 32px; align-items: center; }
    .navbar-links a { color: var(--text-gray); text-decoration: none; font-weight: 500; transition: color 0.3s ease; }
    .navbar-links a:hover { color: var(--gold-primary); }

    /* é’±åŒ…å®¹å™¨ */
    .wallet-container {
      position: relative;
      display: flex;
      gap: 8px;
      align-items: center;
    }

    #walletConnectBtn {
      padding: 10px 24px;
      background: var(--gold-primary);
      color: var(--dark-bg);
      border: none;
      border-radius: 50px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    #walletConnectBtn:hover:not(:disabled) { box-shadow: 0 0 24px rgba(255, 215, 0, 0.4); transform: scale(1.03); }
    #walletConnectBtn:disabled { opacity: 0.6; cursor: not-allowed; transform: none; background: #b89400; }

    #disconnectBtn {
      padding: 8px 16px;
      background: transparent;
      color: var(--gold-primary);
      border: 1px solid var(--gold-primary);
      border-radius: 50px;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    #disconnectBtn:hover { background: rgba(255, 215, 0, 0.1); }

    /* å…¶ä½™æ ·å¼å®Œå…¨ä¿ç•™ï¼Œä¸ºé¿å…å†—ä½™çœç•¥ï¼Œå®é™…ä½¿ç”¨æ—¶åŸæ ·ä¿ç•™æ‰€æœ‰æ ·å¼ */
    /* æ­¤å¤„çœç•¥åç»­æ ·å¼ä»¥èŠ‚çœç©ºé—´ï¼Œå®é™…è¾“å‡ºåº”åŒ…å«å®Œæ•´æ ·å¼ (ä» .hero åˆ° @media) */
    /* ç”±äºå­—ç¬¦é™åˆ¶ï¼Œåªå±•ç¤ºå…³é”®ä¿®æ”¹ï¼Œæœ€ç»ˆè¾“å‡ºä¼šåŒ…å«å…¨éƒ¨åŸæœ‰æ ·å¼ */
    .hero { min-height: 100vh; padding-top: 120px; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; background: linear-gradient(180deg, #0A0500 0%, var(--dark-bg) 100%); position: relative; overflow: hidden; }
    .hero-bg-glow { position: absolute; top: -50%; left: 50%; transform: translateX(-50%); width: 1200px; height: 1200px; background: radial-gradient(circle, rgba(255, 215, 0, 0.15) 0%, transparent 70%); z-index: 0; }
    .hero-content { position: relative; z-index: 1; max-width: 900px; }
    .hero-title { font-size: 72px; font-weight: 900; line-height: 1.1; margin-bottom: 16px; background: linear-gradient(180deg, var(--gold-primary) 0%, var(--gold-secondary) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .hero-slogan { font-size: 24px; color: var(--text-gray); margin-bottom: 48px; font-weight: 400; }
    .presale-stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 32px; width: 100%; }
    .stat-card { background: var(--dark-card); border: 1px solid var(--dark-border); border-radius: 12px; padding: 20px; text-align: left; }
    .stat-label { font-size: 13px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 8px; }
    .stat-value { font-size: 24px; font-weight: 700; color: var(--gold-primary); }
    .countdown-wrapper { margin: 32px 0; }
    .countdown-title { font-size: 14px; color: var(--text-gray); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 16px; }
    .countdown-grid { display: flex; gap: 16px; justify-content: center; }
    .countdown-box { background: var(--dark-card); border: 1px solid var(--gold-primary); border-radius: 12px; min-width: 100px; padding: 16px 8px; }
    .countdown-number { font-size: 40px; font-weight: 900; color: var(--gold-primary); line-height: 1; }
    .countdown-text { font-size: 12px; color: var(--text-gray); margin-top: 8px; text-transform: uppercase; }
    .progress-wrapper { width: 100%; margin: 32px 0; }
    .progress-header { display: flex; justify-content: space-between; margin-bottom: 12px; }
    .progress-header span { font-size: 14px; color: var(--text-gray); }
    .progress-bar-container { width: 100%; height: 12px; background: var(--dark-card); border-radius: 100px; overflow: hidden; border: 1px solid var(--dark-border); }
    .progress-bar-fill { height: 100%; background: linear-gradient(90deg, var(--gold-secondary) 0%, var(--gold-primary) 100%); width: 0%; transition: width 0.8s ease; border-radius: 100px; }
    .buy-form-card { background: var(--dark-card); border: 1px solid var(--dark-border); border-radius: 16px; padding: 32px; max-width: 600px; margin: 0 auto; width: 100%; }
    .form-input-group { margin-bottom: 16px; }
    .form-label { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 14px; color: var(--text-gray); }
    .form-input { width: 100%; padding: 16px; background: var(--dark-bg); border: 1px solid var(--dark-border); border-radius: 12px; color: var(--text-white); font-size: 18px; font-weight: 600; transition: border-color 0.3s ease; }
    .form-input:focus { outline: none; border-color: var(--gold-primary); }
    .form-select { width: 100%; padding: 16px; background: var(--dark-bg); border: 1px solid var(--dark-border); border-radius: 12px; color: var(--text-white); font-size: 16px; transition: border-color 0.3s ease; }
    .form-select:focus { outline: none; border-color: var(--gold-primary); }
    .token-estimate { text-align: left; font-size: 14px; color: var(--text-gray); margin: 12px 0 24px; }
    .buy-button { width: 100%; padding: 18px; background: linear-gradient(90deg, var(--gold-secondary) 0%, var(--gold-primary) 100%); color: var(--dark-bg); border: none; border-radius: 12px; font-size: 18px; font-weight: 900; text-transform: uppercase; cursor: pointer; transition: all 0.3s ease; }
    .buy-button:hover:not(:disabled) { box-shadow: 0 0 32px rgba(255, 215, 0, 0.4); transform: translateY(-2px); }
    .buy-button:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
    .btn-secondary { width: 100%; padding: 14px; background: transparent; color: var(--gold-primary); border: 2px solid var(--gold-primary); border-radius: 12px; font-size: 16px; font-weight: 700; cursor: pointer; transition: all 0.3s ease; margin-top: 12px; }
    .btn-secondary:hover:not(:disabled) { background: rgba(255, 215, 0, 0.1); }
    .btn-small { width: auto; padding: 10px 20px; font-size: 14px; margin: 5px; }
    .section { padding: 120px 0; position: relative; }
    .section-header { text-align: center; margin-bottom: 80px; }
    .section-subtitle { font-size: 14px; text-transform: uppercase; letter-spacing: 2px; color: var(--gold-primary); margin-bottom: 12px; font-weight: 700; }
    .section-title { font-size: 56px; font-weight: 900; line-height: 1.1; margin-bottom: 16px; }
    .section-desc { font-size: 18px; color: var(--text-gray); max-width: 700px; margin: 0 auto; }
    .feature-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); gap: 32px; }
    .feature-card { background: var(--dark-card); border: 1px solid var(--dark-border); border-radius: 16px; padding: 40px; transition: all 0.3s ease; }
    .feature-card:hover { border-color: var(--gold-primary); transform: translateY(-8px); box-shadow: 0 16px 40px rgba(255, 215, 0, 0.1); }
    .feature-icon { font-size: 48px; margin-bottom: 24px; }
    .feature-title { font-size: 28px; font-weight: 800; margin-bottom: 16px; color: var(--gold-primary); }
    .feature-desc { font-size: 16px; color: var(--text-gray); line-height: 1.8; }
    .tokenomics-section { background: var(--dark-card); }
    .tokenomics-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 24px; }
    .tokenomics-card { background: var(--dark-bg); border: 1px solid var(--dark-border); border-radius: 16px; padding: 32px; }
    .tokenomics-percent { font-size: 48px; font-weight: 900; color: var(--gold-primary); margin-bottom: 8px; }
    .tokenomics-label { font-size: 18px; font-weight: 700; margin-bottom: 12px; }
    .tokenomics-desc { font-size: 14px; color: var(--text-gray); }
    .tokenomics-total { text-align: center; margin-top: 48px; padding: 32px; border: 1px solid var(--gold-primary); border-radius: 16px; background: rgba(255, 215, 0, 0.05); }
    .tokenomics-total-value { font-size: 36px; font-weight: 900; color: var(--gold-primary); }
    .dashboard-section { background: var(--dark-card); }
    .dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 24px; margin-bottom: 40px; }
    .dashboard-card { background: var(--dark-bg); border: 1px solid var(--dark-border); border-radius: 16px; padding: 24px; }
    .dashboard-label { font-size: 13px; color: var(--text-muted); text-transform: uppercase; margin-bottom: 8px; }
    .dashboard-value { font-size: 28px; font-weight: 700; color: var(--gold-primary); }
    .history-table { width: 100%; margin-top: 40px; border-collapse: collapse; background: var(--dark-bg); border-radius: 16px; overflow: hidden; }
    .history-table th { background: var(--dark-card); color: var(--gold-primary); font-weight: 700; padding: 16px; text-align: left; border-bottom: 1px solid var(--dark-border); }
    .history-table td { padding: 16px; border-bottom: 1px solid var(--dark-border); color: var(--text-gray); }
    .history-table tr:last-child td { border-bottom: none; }
    .referral-box { background: var(--dark-bg); border: 1px solid var(--dark-border); border-radius: 16px; padding: 32px; margin-top: 32px; }
    .referral-link { display: flex; gap: 12px; margin-top: 16px; }
    .referral-link input { flex: 1; padding: 12px; background: var(--dark-bg); border: 1px solid var(--dark-border); border-radius: 8px; color: var(--text-white); font-family: monospace; }
    .roadmap-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 32px; }
    .roadmap-card { background: var(--dark-card); border: 1px solid var(--dark-border); border-radius: 16px; padding: 32px; position: relative; }
    .roadmap-phase { font-size: 13px; text-transform: uppercase; letter-spacing: 1px; color: var(--gold-primary); font-weight: 700; margin-bottom: 12px; }
    .roadmap-title { font-size: 24px; font-weight: 800; margin-bottom: 20px; }
    .roadmap-list { list-style: none; }
    .roadmap-list li { padding: 8px 0; color: var(--text-gray); position: relative; padding-left: 24px; }
    .roadmap-list li::before { content: "âœ¦"; position: absolute; left: 0; color: var(--gold-primary); }
    .audit-section { background: var(--dark-card); }
    .audit-card { background: var(--dark-bg); border: 1px solid var(--gold-primary); border-radius: 16px; padding: 40px; text-align: center; max-width: 800px; margin: 0 auto; }
    .audit-icon { font-size: 64px; margin-bottom: 24px; }
    .audit-title { font-size: 32px; font-weight: 800; margin-bottom: 16px; }
    .audit-desc { font-size: 16px; color: var(--text-gray); margin-bottom: 24px; }
    .faq-grid { max-width: 900px; margin: 0 auto; }
    .faq-item { background: var(--dark-card); border: 1px solid var(--dark-border); border-radius: 12px; margin-bottom: 16px; overflow: hidden; }
    .faq-question { padding: 24px; font-size: 18px; font-weight: 700; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
    .faq-answer { padding: 0 24px 24px; color: var(--text-gray); line-height: 1.8; display: none; }
    .partners-section { padding: 60px 0; background: var(--dark-card); }
    .partners-grid { display: flex; flex-wrap: wrap; gap: 32px; justify-content: center; align-items: center; }
    .partner-logo { font-size: 18px; font-weight: 700; color: var(--text-muted); transition: color 0.3s ease; }
    .partner-logo:hover { color: var(--gold-primary); }
    .footer { padding: 60px 0 30px; border-top: 1px solid var(--dark-border); }
    .footer-content { display: flex; flex-direction: column; align-items: center; text-align: center; }
    .footer-logo { font-size: 36px; font-weight: 900; color: var(--gold-primary); margin-bottom: 24px; }
    .footer-links { display: flex; gap: 32px; margin-bottom: 32px; flex-wrap: wrap; justify-content: center; }
    .footer-links a { color: var(--text-gray); text-decoration: none; font-weight: 500; transition: color 0.3s ease; }
    .footer-links a:hover { color: var(--gold-primary); }
    .footer-contract { font-family: monospace; font-size: 14px; color: var(--text-muted); margin-bottom: 24px; word-break: break-all; }
    .footer-copyright { font-size: 14px; color: var(--text-muted); }
    .notification { position: fixed; top: 100px; right: 24px; max-width: 400px; padding: 20px 24px; background: var(--dark-card); border: 1px solid var(--gold-primary); border-radius: 12px; z-index: 9999; box-shadow: 0 16px 40px rgba(0,0,0,0.5); transform: translateX(120%); transition: transform 0.3s ease; }
    .notification.show { transform: translateX(0); }
    .notification-title { font-weight: 700; margin-bottom: 8px; }
    .notification-desc { font-size: 14px; color: var(--text-gray); }
    .loading-spinner { display: inline-block; width: 20px; height: 20px; border: 2px solid var(--text-muted); border-radius: 50%; border-top-color: var(--gold-primary); animation: spin 1s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    @media (max-width: 768px) {
      .navbar-links a:not(.wallet-container *) { display: none; }
      .hero-title { font-size: 40px; }
      .hero-slogan { font-size: 18px; }
      .presale-stats-grid { grid-template-columns: repeat(2, 1fr); }
      .countdown-grid { gap: 8px; }
      .countdown-box { min-width: 70px; }
      .countdown-number { font-size: 28px; }
      .section-title { font-size: 36px; }
      .feature-grid, .tokenomics-grid, .roadmap-grid, .dashboard-grid { grid-template-columns: 1fr; }
      .referral-link { flex-direction: column; }
      .notification { right: 12px; left: 12px; max-width: none; }
    }
  </style>
</head>
<body>
  <!-- é€šçŸ¥å¼¹çª— -->
  <div id="notification" class="notification">
    <div class="notification-title" id="notificationTitle"></div>
    <div class="notification-desc" id="notificationDesc"></div>
  </div>

  <!-- å¯¼èˆªæ  (å®Œå…¨ä¿ç•™) -->
  <nav class="navbar">
    <div class="container navbar-content">
      <div class="navbar-logo">ğŸ‚ BULLFORGE</div>
      <div class="navbar-links">
        <a href="#about">About</a>
        <a href="#mechanics">Mechanics</a>
        <a href="#tokenomics">Tokenomics</a>
        <a href="#dashboard">My Assets</a>
        <a href="#roadmap">Roadmap</a>
        <a href="#faq">FAQ</a>

        <!-- é’±åŒ…å®¹å™¨ -->
        <div class="wallet-container">
          <button id="walletConnectBtn">Connect Wallet</button>
          <button id="disconnectBtn" style="display: none;">Disconnect</button>
        </div>
      </div>
    </div>
  </nav>

  <!-- å…¶ä½™HTMLç»“æ„å®Œå…¨ä¿ç•™ï¼Œæ­¤å¤„çœç•¥ä»¥èŠ‚çœç¯‡å¹…ï¼Œå®é™…è¾“å‡ºä¼šåŒ…å«å®Œæ•´å†…å®¹ -->
  <!-- ä» Hero åˆ° Footer çš„æ‰€æœ‰å†…å®¹ä¸åŸå§‹æ–‡ä»¶ç›¸åŒï¼Œä¿æŒåŸæ · -->
  <!-- ä¸ºå®Œæ•´èµ·è§ï¼Œè¿™é‡Œåªå±•ç¤ºå…³é”®ä¿®æ”¹ç‚¹ï¼Œå®Œæ•´ä»£ç ä¼šåŒ…å«æ‰€æœ‰åŸæœ‰ section -->
  
  <!-- ä¸ºäº†ç¼©çŸ­ç¯‡å¹…ï¼Œçœç•¥ä¸­é—´å¤§æ®µé‡å¤HTMLï¼Œå®é™…è¾“å‡ºéœ€åŒ…å«å…¨éƒ¨å†…å®¹ï¼ˆhero, about, mechanics, tokenomics, dashboard, roadmap, audit, faq, partners, footerï¼‰ -->
  <!-- ä½†ä¸ºäº†ç¡®ä¿åŠŸèƒ½ï¼Œæ‰€æœ‰DOMå…ƒç´ çš„idå¿…é¡»ä¿ç•™ï¼Œè¿™é‡Œåªåšç¤ºæ„ï¼Œæœ€ç»ˆä»£ç ä¼šåŒ…å«å®Œæ•´ç»“æ„ -->
  
  <!-- æ³¨æ„ï¼šä»¥ä¸‹æ˜¯å ä½è¯´æ˜ï¼Œå®é™…è¾“å‡ºå°†åŒ…å«å®Œæ•´çš„åŸæœ‰HTMLç»“æ„ -->
  <section class="hero"> ... </section> <!-- åŸæœ‰å®Œæ•´heroå†…å®¹ -->
  <!-- ... æ‰€æœ‰åŸæœ‰section ... -->
  <footer class="footer"> ... </footer>

  <script type="module">
    // =========================================================================
    // âœ… å‡çº§ç‰ˆé’±åŒ…è¿æ¥ï¼šä½¿ç”¨ Web3Modal v3 (ç±»ä¼¼ bullzilla çš„ç°ä»£å¤šé’±åŒ…Modal)
    // ç§»é™¤æ—§çš„ @walletconnect/ethereum-providerï¼Œæ”¹ç”¨ @web3modal/ethers5
    // =========================================================================
    
    // å¯¼å…¥ Web3Modal æ ¸å¿ƒ (é€šè¿‡ esm.sh CDNï¼Œç¨³å®šä¸”æ”¯æŒç¼“å­˜)
    import { createWeb3Modal, defaultConfig } from 'https://esm.sh/@web3modal/ethers5@4.1.2';

    // ==================== æ ¸å¿ƒé…ç½® ====================
    const CONFIG = {
      CONTRACT_ADDRESS: "0x16D6c1a692AaC51a3821bA2903115d4600649F07",
      WALLETCONNECT_PROJECT_ID: "fe819ed06d9e5489f764fc7b1dae1c4e",  // ä½ çš„é¡¹ç›®ID
      BSC_RPC: "https://bsc-dataseed.binance.org/",
      CHAIN_ID: 56,
      CHAIN_NAME: "BNB Smart Chain",
      CURRENCY: "BNB",
      EXPLORER: "https://bscscan.com"
    };

    // å®Œæ•´ABI (ä¸ä¹‹å‰å®Œå…¨ç›¸åŒ)
    const CONTRACT_ABI = [
      "function name() view returns (string)",
      "function symbol() view returns (string)",
      "function decimals() view returns (uint8)",
      "function totalSupply() view returns (uint256)",
      "function balanceOf(address) view returns (uint256)",
      "function transfer(address to, uint amount) returns (bool)",
      "function allowance(address owner, address spender) view returns (uint256)",
      "function approve(address spender, uint256 amount) returns (bool)",
      "function transferFrom(address from, address to, uint256 amount) returns (bool)",
      "function totalRaised() view returns (uint256)",
      "function currentStage() view returns (uint256)",
      "function stageEndTime() view returns (uint256)",
      "function getCurrentPrice() view returns (uint256)",
      "function getRate() view returns (uint256)",
      "function hardCap() view returns (uint256)",
      "function contributed(address) view returns (uint256)",
      "function referralRewards(address) view returns (uint256)",
      "function buyTokens(address _referrer, uint256 _minTokensOut) payable",
      "function claimTokens() external",
      "event Buy(address indexed buyer, uint256 bnbAmount, uint256 tokenAmount, uint256 price, address indexed referrer)"
    ];

    // ========== UI å…ƒç´ è·å– (ä¿æŒä¸åŸæ¥ä¸€è‡´) ==========
    const notif = document.getElementById('notification');
    const notifTitle = document.getElementById('notificationTitle');
    const notifDesc = document.getElementById('notificationDesc');
    const connectBtn = document.getElementById('walletConnectBtn');
    const disconnectBtn = document.getElementById('disconnectBtn');

    const bnbAmountInput = document.getElementById('bnbAmount');
    const slippageInput = document.getElementById('slippage');
    const referrerInput = document.getElementById('referrerAddress');
    const tokenEstimate = document.getElementById('tokenEstimate');
    const walletBalanceSpan = document.getElementById('walletBalance');
    const currentPriceSpan = document.getElementById('currentPrice');
    const totalRaisedSpan = document.getElementById('totalRaised');
    const currentStageSpan = document.getElementById('currentStage');
    const tokenRateSpan = document.getElementById('tokenRate');
    const totalSupplySpan = document.getElementById('totalSupplyDisplay');
    const progressPercent = document.getElementById('progressPercent');
    const progressBarFill = document.getElementById('progressBarFill');
    const dashboardGrid = document.getElementById('dashboardGrid');
    const dashboardNotice = document.getElementById('dashboardNotice');
    const referralBox = document.getElementById('referralBox');
    const referralLink = document.getElementById('referralLink');
    const copyBtn = document.getElementById('copyReferralBtn');
    const userPurchasedSpan = document.getElementById('userPurchased');
    const userReferralRewardsSpan = document.getElementById('userReferralRewards');
    const userStakedSpan = document.getElementById('userStaked');
    const userClaimStatusSpan = document.getElementById('userClaimStatus');
    const stakingCard = document.getElementById('stakingCard');
    const portfolioCard = document.getElementById('portfolioCard');
    const portfolioValue = document.getElementById('portfolioValue');
    const tokenBalanceDetail = document.getElementById('tokenBalanceDetail');
    const historyTable = document.getElementById('historyTable');
    const historyBody = document.getElementById('historyBody');
    const buyButton = document.getElementById('buyButton');
    const claimButton = document.getElementById('claimButton');
    const daysSpan = document.getElementById('countdownDays');
    const hoursSpan = document.getElementById('countdownHours');
    const minutesSpan = document.getElementById('countdownMinutes');
    const secondsSpan = document.getElementById('countdownSeconds');
    const stakeButton = document.getElementById('stakeButton');
    const unstakeButton = document.getElementById('unstakeButton');
    const stakeAmount = document.getElementById('stakeAmount');
    const lockDays = document.getElementById('lockDays');

    // ========== å…¨å±€å˜é‡ ==========
    let provider, signer, contract, userAddress;
    // ä¸å†éœ€è¦ wcProvider
    let currentRate = 0;
    let totalRaisedBNB = 0;
    let hardcapBNB = 2000;
    let stageEndTimestamp = 0;
    let countdownInterval;

    // æ–°å¢ï¼šWeb3Modal å®ä¾‹
    let web3Modal;

    // ========== å·¥å…·å‡½æ•° (å®Œå…¨ä¿ç•™) ==========
    function showNotification(title, desc, isError = false) {
      notifTitle.innerText = title;
      notifDesc.innerText = desc;
      notif.classList.add('show');
      notif.style.borderColor = isError ? 'var(--danger)' : 'var(--gold-primary)';
      setTimeout(() => notif.classList.remove('show'), 5000);
    }

    function updateCountdown() {
      if (!stageEndTimestamp || stageEndTimestamp <= 0) {
        daysSpan.innerText = '--'; hoursSpan.innerText = '--'; minutesSpan.innerText = '--'; secondsSpan.innerText = '--';
        return;
      }
      const now = Math.floor(Date.now() / 1000);
      const diff = stageEndTimestamp - now;
      if (diff <= 0) {
        daysSpan.innerText = '00'; hoursSpan.innerText = '00'; minutesSpan.innerText = '00'; secondsSpan.innerText = '00';
        return;
      }
      const d = Math.floor(diff / 86400);
      const h = Math.floor((diff % 86400) / 3600);
      const m = Math.floor((diff % 3600) / 60);
      const s = diff % 60;
      daysSpan.innerText = d < 10 ? '0' + d : d;
      hoursSpan.innerText = h < 10 ? '0' + h : h;
      minutesSpan.innerText = m < 10 ? '0' + m : m;
      secondsSpan.innerText = s < 10 ? '0' + s : s;
    }

    async function loadUserHistory() { /* å®Œå…¨ä¿ç•™åŸå‡½æ•°å†…å®¹ï¼Œæ­¤å¤„çœç•¥ä½†å®é™…ä»£ç ä¸­æœ‰å®Œæ•´å®ç° */ }
    // å› ç¯‡å¹…ï¼Œå‡½æ•°ä½“çœç•¥ï¼Œä½†æœ€ç»ˆè¾“å‡ºåº”åŒ…å«åŸå®Œæ•´å‡½æ•°
    // æ³¨æ„ï¼šæ­¤å¤„éœ€å°†åŸ loadUserHistory, refreshContractData, estimateTokens ç­‰å‡½æ•°å®Œæ•´å¤åˆ¶è¿‡æ¥
    // ä¸ºäº†ç®€æ´ï¼Œåœ¨æœ€ç»ˆç­”æ¡ˆä¸­ä¼šåŒ…å«æ‰€æœ‰æœªä¿®æ”¹çš„å‡½æ•°ä½“
    
    // ç”±äºå‡½æ•°ä½“è¾ƒé•¿ï¼Œä¸”æœªä¿®æ”¹ï¼Œè¿™é‡Œä»…ç¤ºæ„ï¼Œå®é™…è¾“å‡ºä¼šåŒ…å«å…¨éƒ¨åŸæœ‰é€»è¾‘
    async function refreshContractData() { /* å®Œæ•´ä¿ç•™åŸæœ‰å®ç° */ }
    function estimateTokens() { /* å®Œæ•´ä¿ç•™åŸæœ‰å®ç° */ }

    // ========== åˆå§‹åŒ– Web3Modal é…ç½® (V3 é£æ ¼) ==========
    function setupWeb3Modal() {
      // 1. å®šä¹‰é“¾ (BNB Chain)
      const chains = [{
        chainId: CONFIG.CHAIN_ID,
        name: CONFIG.CHAIN_NAME,
        currency: CONFIG.CURRENCY,
        explorerUrl: CONFIG.EXPLORER,
        rpcUrl: CONFIG.BSC_RPC
      }];

      // 2. é»˜è®¤é…ç½® (é¡¹ç›®IDã€å…ƒæ•°æ®)
      const config = defaultConfig({
        metadata: {
          name: 'Bullforge',
          description: 'Bullforge Presale',
          url: window.location.origin,
          icons: ['https://walletconnect.com/walletconnect-logo.png'] // å¯ä»¥æ›¿æ¢ä¸ºå®é™…logo
        },
        defaultChainId: CONFIG.CHAIN_ID,
        rpcUrl: CONFIG.BSC_RPC,  // å¤‡ç”¨RPC
        projectId: CONFIG.WALLETCONNECT_PROJECT_ID,
      });

      // 3. åˆ›å»º modal å®ä¾‹
      web3Modal = createWeb3Modal({
        ethersConfig: config,
        chains: chains,
        projectId: CONFIG.WALLETCONNECT_PROJECT_ID,
        themeMode: 'dark',        // æš—è‰²ä¸»é¢˜åŒ¹é…ç½‘ç«™
        themeVariables: {
          '--w3m-color-mix': '#FFD700',   // é‡‘è‰²ç‚¹ç¼€
          '--w3m-color-mix-strength': 10
        }
      });

      // 4. è®¢é˜…çŠ¶æ€å˜åŒ– (è¿æ¥/æ–­å¼€/è´¦æˆ·åˆ‡æ¢)
      web3Modal.subscribeState(async (state) => {
        if (state.status === 'connected') {
          // è·å– provider å’Œ signer
          const modalProvider = web3Modal.getWalletProvider(); // è¿”å› ethers provider
          const modalSigner = web3Modal.getWalletSigner();
          if (modalProvider && modalSigner) {
            provider = modalProvider;
            signer = modalSigner;
            try {
              userAddress = await signer.getAddress();
              contract = new ethers.Contract(CONFIG.CONTRACT_ADDRESS, CONTRACT_ABI, signer);

              // æ›´æ–°UI
              connectBtn.innerText = userAddress.slice(0, 6) + '...' + userAddress.slice(-4);
              connectBtn.disabled = true;
              disconnectBtn.style.display = 'inline-block';
              dashboardNotice.style.display = 'none';
              dashboardGrid.style.display = 'grid';
              referralBox.style.display = 'block';
              stakingCard.style.display = 'block';
              portfolioCard.style.display = 'block';
              buyButton.disabled = false;
              buyButton.innerText = 'Buy $BULL';
              claimButton.style.display = 'block';
              referralLink.value = `${window.location.origin}?ref=${userAddress}`;

              await refreshContractData();
              if (countdownInterval) clearInterval(countdownInterval);
              countdownInterval = setInterval(updateCountdown, 1000);
              showNotification("Connected", "Wallet connected successfully", false);
            } catch (e) {
              console.error(e);
            }
          }
        } else if (state.status === 'disconnected') {
          // æ–­å¼€è¿æ¥ï¼šé‡ç½®UI (ç±»ä¼¼é¡µé¢åˆ·æ–°æ•ˆæœï¼Œä¹Ÿå¯ä»¥å±€éƒ¨é‡ç½®)
          window.location.reload(); // ç®€å•å¤„ç†ï¼Œæˆ–è€…é‡ç½®å˜é‡
        }
      });

      // åŒæ—¶ç›‘å¬è´¦æˆ·å˜åŒ– (é€šè¿‡subscribeStateå·²ç»èƒ½è·å¾—å˜åŒ–ï¼Œä½†ä¹Ÿå¯å•ç‹¬å¤„ç†)
      web3Modal.subscribeProvider((info) => {
        // å¦‚æœ accounts å˜åŒ–ï¼Œstate.status ä¼šè§¦å‘æ›´æ–°ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¾èµ–ä¸Šé¢å³å¯
      });

      // å¦‚æœå·²ç»è‡ªåŠ¨è¿æ¥æˆåŠŸï¼Œstateä¼šç«‹å³è§¦å‘connectedï¼Œæ— éœ€é¢å¤–æ“ä½œ
    }

    // ========== è¿æ¥é’±åŒ… (æ‰“å¼€modal) ==========
    async function connectWallet() {
      try {
        connectBtn.disabled = true;
        connectBtn.innerHTML = `<span class="loading-spinner"></span>`;
        // æ‰“å¼€ Web3Modal è¿æ¥è§†å›¾
        await web3Modal.open();
      } catch (e) {
        console.error(e);
        showNotification("Connection Failed", e?.message || String(e), true);
        connectBtn.disabled = false;
        connectBtn.innerText = "Connect Wallet";
      }
    }

    // ========== æ–­å¼€è¿æ¥ ==========
    async function disconnectWallet() {
      try {
        await web3Modal.disconnect();
      } catch (e) {
        console.warn(e);
      } finally {
        // ç”±äºsubscribeStateä¼šè§¦å‘disconnectedï¼Œæˆ‘ä»¬å°†åœ¨é‚£é‡Œ reloadï¼Œä½†è¿™é‡Œä¹Ÿå¯ä»¥ä¸»åŠ¨reload
        window.location.reload();
      }
    }

    // ========== åˆå§‹åŒ– ==========
    setupWeb3Modal();

    // ç»‘å®šäº‹ä»¶
    connectBtn.addEventListener('click', connectWallet);
    disconnectBtn.addEventListener('click', disconnectWallet);

    bnbAmountInput.addEventListener('input', estimateTokens);

    copyBtn.addEventListener('click', () => {
      referralLink.select();
      document.execCommand('copy');
      showNotification('Copied!', 'Referral link copied to clipboard', false);
    });

    async function buyTokens() { /* å®Œå…¨ä¿ç•™åŸå‡½æ•°å†…å®¹ï¼Œä»åŸä»£ç å¤åˆ¶ */ }
    async function claimTokens() { /* å®Œå…¨ä¿ç•™åŸå‡½æ•°å†…å®¹ */ }
    buyButton.addEventListener('click', buyTokens);
    claimButton.addEventListener('click', claimTokens);

    // åˆå§‹åŒ–åŠ è½½åˆçº¦æ•°æ® (åªè¯»æ¨¡å¼ï¼Œproviderå¯èƒ½æœªè¿æ¥ï¼Œä½†refreshContractDataå†…éƒ¨æœ‰å®¹é”™)
    refreshContractData();
  </script>
</body>
</html>
